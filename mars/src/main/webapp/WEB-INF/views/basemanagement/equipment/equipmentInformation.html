<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
  xmlns:vu="http://www.morphbit.com/thymeleaf/component"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{templates/mmcDetailNavLayout}"
>
	<head>
		<title>Equipment Information</title>
		<script th:src="@{/vertigo-ui/static/js/v-components/v-comments.js}"></script>
	</head>
	
	<body>
	
		<section layout:fragment="content-nav">
			<nav v-scroll-spy="{offset:150}">
			    <q-list link style="height:100%">
			        <q-item tag="a" href="#health">Health Condition</q-item>
			        <q-item tag="a" href="#general">General Information</q-item>
			        <q-item tag="a" href="#financial">Financial value</q-item>				      
	        	</q-list>
	        </nav>
		</section>
		
		<section>
				<div layout:fragment="content-header-left" id="equipmentIcon" >
					<div class="detailType" >
						<q-icon th:name="${model.business.icon}" class="detailTypeIcon q-mx-md" ></q-icon>
					</div>
				</div>
				<div layout:fragment="content-header-title" id="equipmentTitle">
					<span class="text-bigger" th:text="${model.equipment.name?:'New Equipment'}"></span>
					<br/><span class="text-smaller" th:text="${model.equipment.code}"></span>
				</div>
				<div th:if="${!model.modeCreate}" layout:fragment="content-header-actions">
					<vu:button-submit th:if="${model.modeEdit}"   action="@{_cancel}" :round size="lg" color="primary" icon="fas fa-ban" :flat aria-label="Cancel" title="Cancel" class="on-left"  />
					<vu:button-submit th:if="${model.modeReadOnly}" action="@{_edit}" :round size="lg" color="primary" icon="edit" aria-label="Edit" title="Edit" class="on-left"/>
					<v-comments th:base-url="@{/api/}" concept="equipment" th:id="${model.equipment.equipmentId}" :connected-account="vueData.connectedUser.personId" ></v-comments>	
				</div>
				<div th:if="${!model.modeCreate}" layout:fragment="content-header-tabs">
					<q-btn flat type="a" class="active" th:href="@{/basemanagement/equipment/} + ${model.equipment.equipmentId}">Information</q-btn>
					<q-btn flat type="a" th:href="@{/basemanagement/equipment/maintenance/} + ${model.equipment.equipmentId}">Maintenance</q-btn>
					<q-btn flat type="a" th:href="@{/basemanagement/equipment/environment/} + ${model.equipment.equipmentId}">Environment</q-btn>
					<q-btn flat type="a" th:href="@{/basemanagement/equipment/vr/} + ${model.equipment.equipmentId}">VR View</q-btn>
					<q-btn flat type="a" th:href="@{/basemanagement/equipment/spare/} + ${model.equipment.equipmentId}">Spare Parts</q-btn>
				</div>
		</section>
		
		<section layout:fragment="content" >
			<vu:form>
				<div id="health" class="row gutter-md" th:if="${!model.modeCreate}" >
					<div class="col-md-3 col-xs-12">
						<q-card class="bg-white text-center" >
							<q-card-title class="indicator-title text-faded">Health</q-card-title>
							<q-card-main>
								<q-knob
								  th::value="${model.equipment.healthLevel}"
								  :min="0"
								  :max="100"
								  color="positive"
								  :readonly="true" style="font-size: 2rem"></q-knob>
							</q-card-main>
						</q-card>
					</div>
					<div class="col-md-9 col-xs-12">
						<q-card class="bg-white row justify-around items-center" style="height:100%;">
							<div class="text-center"> <span class="indicator text-positive" th:text="${model.equipmentMaintenanceOverview.openedTickets}"/><br/><span class="indicator-title text-faded">Opened Tickets(s)</span></div>
							<div class="text-center"> <span class="indicator text-positive" th:text="${model.equipmentMaintenanceOverview.workOrdersInprogress}"/><br/><span class="indicator-title text-faded">WorkOrder(s) in progress</span></div>
						</q-card>
					</div>
				</div>
				<vu:block id="general" title="General Information">
					<vu:grid cols="2">
						<vu:text-field object="equipment" field="name"/>
						<vu:text-field object="equipment" field="code"/>
						<vu:autocomplete object="equipment" field="baseId" list="bases" labelField="name"/>
						<vu:select object="equipment" field="equipmentTypeId" list="equipmentTypes" />
						<vu:select object="equipment" field="businessId" list="businesses" labelField="name" />
						<vu:date object="equipment" field="purchaseDate" />
						<vu:chips-autocomplete object="equipment" field="tags" list="tags" staticData="true" />
						<vu:text-field object="equipment" field="geoLocation" />
					</vu:grid>
				</vu:block>
				<vu:block id="financial" title="Financial value">
					<vu:grid cols="2">
						<vu:text-field object="equipment" field="equipmentValue" suffix=" €"/>
						<vu:text-field object="equipment" field="rentingFee" suffix=" €"/>
					</vu:grid>
				</vu:block>
				<q-page-sticky position="bottom-right" :offset="[64, 64]">
					<vu:button-submit th:if="${model.modeEdit}"   size="lg" icon="save" label="Save" action="@{_save}" color="primary" />
					<vu:button-submit th:if="${model.modeCreate}" size="lg" icon="save" label="Create" action="@{_create}" color="primary" />
				</q-page-sticky>
				
			</vu:form>
		</section>
	</body>
</html>